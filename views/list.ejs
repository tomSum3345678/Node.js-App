<!DOCTYPE html>
<html>
<head>
    <title>Product List - Supermarket Management System</title>
</head>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0px;
    background-color: #f9f9f9;
    color: #333;
}

.body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    margin: 0;
    padding: 20px;
}
.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #8e4585;
  color: white;
  padding: 10px 20px;
}

.navbar-brand {
  font-size: 24px;
}

.navbar-actions {
  display: flex;
  align-items: center;
}

.custom-link {
  color: inherit;
  text-decoration: none;
  position: relative;
}

.user-info {
  display: flex;
  align-items: center;
  margin-right: 20px;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  margin-right: 10px;
}

.btn {
  background-color: white;
  color: #007bff;
  border: none;
  border-radius: 5px;
  padding: 5px 10px;
  text-decoration: none;
  margin-left: 10px;
}

.btn:hover {
  background-color: rgba(255, 255, 255, 0.8);
}

h1, h2 {
    color: #4A4A4A;
    text-align: center;
}

a {
    color: #007BFF;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

.container {
    max-width: 800px; /* Container width for better readability */
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

form {
    margin-bottom: 20px;
}

label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
}

input[type="text"],
select {
    width: 100%; /* Full-width for responsive design */
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box; /* Ensure padding is included in width */
}

button {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s ease;
    width: calc(50% - 5px); /* Adjust width for two buttons */
}

button:hover {
    background-color: #218838;
}

.product-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Responsive grid layout */
    gap: 20px; /* Spacing between products */
}

.product {
    background: #fff;
    padding: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column; /* Column layout */
    justify-content: space-between; /* Space out children */
}

.product img {
    max-width: 100%; /* Image responsive */
    height: auto; /* Maintain aspect ratio */
}

.product h3 {
    margin: 10px 0;
}

.product div {
    margin: 5px 0;
}

.product .delete {
    color: red; /* Red color for delete link */
}

.product .edit {
    color: #007BFF; /* Default color for edit link */
}

/* Responsive Media Queries */
@media (max-width: 600px) {
    body {
        padding: 10px;
    }

    button {
        width: 100%; /* Full-width buttons on smaller screens */
    }
}
</style>
<body>
<nav class="navbar">
    <div class="navbar-brand">
     <a href='/' class="custom-link">üè†Ô∏éHome</a>
    </div>
    
    <div class="navbar-actions">
      <% if (isAuthenticated) { %>
        <div class="user-info">
          <% if (user.picture) { %>
            <img src="<%= user.picture %>" alt="Avatar" class="user-avatar">
          <% } else { %> 
          <% } %>
          <span style="color: #333; font-weight: 600;">
            <%= user.displayName || user.email %>
          </span>
        </div>
        
        <% if (['staff', 'manager', 'storage'].includes(user.role)) { %>
          <a href="/find" class="btn btn-dashboard">üìä Dashboard</a>
        <% } %>
        
        <a href="/logout" class="btn btn-logout">üö™ Logout</a>
      <% } else { %>
        <a href="/login" class="btn btn-login">üîê Login</a>
      <% } %>
    </div>
  </nav>
    <div class='body'>
    <div class="container">
        <h1>Supermarket Product Management System</h1>
        <a href="/create">Create New Product</a> |¬†
        <a href="/find">View All Products</a>

        <div>
            <h3>Search Products</h3>
            <form action="/find" method="GET">
                <label>Product Name:</label>
                <input type="text" name="productName" value="<%= typeof productName !== 'undefined' ? productName : '' %>">
                
                <label>Category:</label>
                <select name="category">
                    <option value="">All Categories</option>
                    <option value="Food" <%= (typeof category !== 'undefined' && category === 'Food') ? 'selected' : '' %>>Food</option>
                    <option value="Beverages" <%= (typeof category !== 'undefined' && category === 'Beverages') ? 'selected' : '' %>>Beverages</option>
                    <option value="Daily Necessities" <%= (typeof category !== 'undefined' && category === 'Daily Necessities') ? 'selected' : '' %>>Daily Necessities</option>
                    <option value="Cleaning Supplies" <%= (typeof category !== 'undefined' && category === 'Cleaning Supplies') ? 'selected' : '' %>>Cleaning Supplies</option>
                    <option value="Stationery" <%= (typeof category !== 'undefined' && category === 'Stationery') ? 'selected' : '' %>>Stationery</option>
                    <option value="Other" <%= (typeof category !== 'undefined' && category === 'Other') ? 'selected' : '' %>>Other</option>
                </select>
                
                <button type="submit">Search</button>
                <a href="/find">Clear</a>
            </form>
        </div>

        <h2>Product List (<%= nProducts %>)</h2>
        
        <% if (nProducts === 0) { %>
            <p>No products found matching your criteria.</p>
        <% } else { %>
            <div class="product-list">
                <% for (var product of products) { %>
                <div class="product">
                    <% if (product.productImage) { %>
                        <a href="/details?_id=<%= product._id %>">
                            <img src="data:image/jpg;base64, <%= product.productImage %>" alt="<%= product.productName %>">
                        </a>
                    <% } else { %>
                        <div>No Image</div>
                    <% } %>
                    
                    <h3>
                        <a href="/details?_id=<%= product._id %>"><%= product.productName %></a>
                    </h3>
                    <div>ID: <%= product.productId %></div>
                    <div>Category: <%= product.category %></div>
                    <div>Price: $<%= product.price %></div>
                    <div>Stock: <%= product.stock %></div>
                    
                    <div>
                        <a href="/edit?_id=<%= product._id %>">Edit</a>
                        <a href="/delete?_id=<%= product._id %>" onclick="return confirm('Are you sure you want to delete this product?')" class='delete'>Delete</a>
                    </div>
                </div>
                <% } %>
            </div>
        <% } %>
    </div>
    </div>
</body>
</html>
